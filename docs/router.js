import("./sitemap.js");export const navEvent=async e=>{console.log("navEvent",e);let t=(e.target.href||e.target.location.href).replace(window.origin,"");t.split("#")[0]!=window.oldRoute.split("#")[0]&&(await handleRoute(t),window.oldRoute=t),-1==t.indexOf("#")&&window.scrollTo({top:0,behavior:"smooth"});let o=document.getElementById(t.split("#")[1]);o&&o.scrollIntoView({behavior:"smooth"})};export const handleRoute=async e=>{console.log("handleRoute",e);let t=await(await fetch(`./posts/${e.replace("/","").replace(".html","")||"index"}.json`)).json();window.meta=t.meta,meta.content=t.content,document.title=window.meta.title,window?.template?.className!==window.meta.template&&(window.newTemplate=!0,document.body.innerHTML=await(await fetch(`./${window.meta.template}.html`)).text(),await loadScripts()),window.dispatchEvent(new CustomEvent("templateLoaded")),setTimeout((()=>{document.querySelectorAll('a[href^="./"]').forEach((e=>e.removeEventListener("click",window.redirect))),document.querySelectorAll('a[href^="./"]').forEach((e=>e.addEventListener("click",window.redirect)))}),100)};const loadScripts=async()=>{Array.from(document.getElementsByTagName("script")).forEach((e=>{if(new RegExp("head|helmet","i").test(e.getAttribute("src")))return void e.remove();if(console.log({script:e},e.getAttribute("src")),new RegExp("main|router","i").test(e.getAttribute("src")))return;if(!e.getAttribute("tag"))return;const t=document.createElement("script");e.textContent&&(t.textContent=e.textContent),e.src&&(t.src=e.src),e.async&&(t.async=e.async),e.type&&(t.type=e.type),e.parentNode.replaceChild(t,e)}))};